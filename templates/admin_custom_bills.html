{% extends "base.html" %}
{% block title %}Custom Billing Records{% endblock %}
{% block content %}

<div class="p-6">
  <h1 class="text-3xl font-bold mb-6 text-gray-900 dark:text-white">
    Custom Billing Records
  </h1>

  <!-- Add new record -->
  <form action="{{ url_for('admin_custom_bill_add') }}" method="POST"
        class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow mb-6 border border-gray-200 dark:border-gray-700">
    <h2 class="text-lg font-semibold mb-3 text-gray-800 dark:text-gray-200">Add New Record</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <input type="text" name="person_name" placeholder="Name" required
             class="border p-2 rounded w-full dark:bg-gray-700 dark:text-white">
      <input type="text" name="phone_number" placeholder="Phone Number"
             class="border p-2 rounded w-full dark:bg-gray-700 dark:text-white">
      <input type="text" name="address" placeholder="Address"
             class="border p-2 rounded w-full dark:bg-gray-700 dark:text-white">
      <input type="number" step="0.01" name="amount_pending" placeholder="Amount Pending ₹"
             class="border p-2 rounded w-full dark:bg-gray-700 dark:text-white">
    </div>
    <textarea name="short_note" rows="2" placeholder="Short Note"
              class="border p-2 rounded w-full mt-3 dark:bg-gray-700 dark:text-white"></textarea>
    <button type="submit"
            class="mt-4 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">
      Add Entry
    </button>
  </form>

  <!-- Records table -->
  <div class="overflow-x-auto">
    <table class="min-w-full border-collapse border border-gray-300 dark:border-gray-600">
      <thead class="bg-gray-100 dark:bg-gray-700">
        <tr>
          <th class="border p-2">Name</th>
          <th class="border p-2">Phone</th>
          <th class="border p-2">Address</th>
          <th class="border p-2">Amount (₹)</th>
          <th class="border p-2">Note</th>
          <th class="border p-2">Last Updated</th>
          <th class="border p-2">Action</th>
        </tr>
      </thead>
      <tbody class="bg-white dark:bg-gray-800">
        {% for rec in records %}
        <tr class="text-center border-t dark:border-gray-700">
          <form action="{{ url_for('admin_custom_bill_update', record_id=rec.id) }}" method="POST">
            <td class="border p-2"><input type="text" name="person_name" value="{{ rec.person_name }}" class="border p-1 rounded w-full dark:bg-gray-700 dark:text-white"></td>
            <td class="border p-2"><input type="text" name="phone_number" value="{{ rec.phone_number }}" class="border p-1 rounded w-full dark:bg-gray-700 dark:text-white"></td>
            <td class="border p-2"><input type="text" name="address" value="{{ rec.address }}" class="border p-1 rounded w-full dark:bg-gray-700 dark:text-white"></td>
            <td class="border p-2"><input type="number" step="0.01" name="amount_pending" value="{{ rec.amount_pending }}" class="border p-1 rounded w-full text-right dark:bg-gray-700 dark:text-white"></td>
            <td class="border p-2"><input type="text" name="short_note" value="{{ rec.short_note }}" class="border p-1 rounded w-full dark:bg-gray-700 dark:text-white"></td>
            <td class="border p-2 text-sm">{{ rec.last_updated[:19] if rec.last_updated else '—' }}</td>
            <td class="border p-2"><button class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded">Save</button></td>
          </form>
        </tr>
        {% else %}
        <tr><td colspan="7" class="border p-3 text-center">No records yet.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
